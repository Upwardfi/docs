function copyToClipboard(container) {
  const el = document.createElement('textarea');
  el.value = container.textContent.replace(/\n$/, '');
  document.body.appendChild(el);
  el.select();
  document.execCommand('copy');
  document.body.removeChild(el);
}

function setupCodeCopy() {
  $('pre.highlight').prepend('<div class="copy-clipboard"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><title>Copy to Clipboard</title><path xmlns="http://www.w3.org/2000/svg" fill-rule="evenodd" clip-rule="evenodd" d="M3.60938 0.546875C2.09059 0.546875 0.859375 1.77809 0.859375 3.29688V14.0938C0.859375 15.4735 1.88723 16.6133 3.21902 16.789C3.6998 17.5894 4.57642 18.125 5.57812 18.125H13.0625C14.5813 18.125 15.8125 16.8938 15.8125 15.375V5.89062C15.8125 5.69171 15.7335 5.50095 15.5928 5.36029L13.6241 3.39154C13.3312 3.09865 12.8563 3.09865 12.5634 3.39154C12.2705 3.68444 12.2705 4.15931 12.5634 4.45221L14.3125 6.20128V15.375C14.3125 16.0654 13.7529 16.625 13.0625 16.625H5.57812C4.88777 16.625 4.32812 16.0654 4.32812 15.375V4.60938C4.32812 3.91902 4.88777 3.35938 5.57812 3.35938H8.73438V7.20312C8.73438 7.61734 9.07016 7.95312 9.48438 7.95312H12.4375C12.8517 7.95312 13.1875 7.61734 13.1875 7.20312C13.1875 6.78891 12.8517 6.45312 12.4375 6.45312H10.2344V2.60938C10.2344 2.19516 9.89859 1.85938 9.48438 1.85938H8.01172C8.16742 1.72195 8.26562 1.52088 8.26562 1.29688C8.26562 0.882661 7.92984 0.546875 7.51562 0.546875H3.60938ZM4.57805 2.04688H3.60938C2.91902 2.04688 2.35938 2.60652 2.35938 3.29688V14.0938C2.35938 14.484 2.54279 14.8314 2.82812 15.0545V4.60938C2.82812 3.44341 3.55375 2.44693 4.57805 2.04688Z" fill="#7DBB85"/>/svg></div>');
  $('.copy-clipboard').on('click', function() {
    copyToClipboard(this.parentNode.children[1]);
  });
}
